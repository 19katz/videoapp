{"map":{"version":3,"sources":["js/main.050a55ee.chunk.js"],"names":["this","push","184","module","__webpack_exports__","__webpack_require__","r","react","react_default","n","react_dom","react_dom_default","regenerator","regenerator_default","asyncToGenerator","slicedToArray","src_Lobby","_ref","username","handleUsernameChange","roomName","handleRoomNameChange","handleSubmit","a","createElement","onSubmit","htmlFor","type","id","value","onChange","required","toConsumableArray","es5","es5_default","src_Participant","participant","_useState","Object","_useState2","videoTracks","setVideoTracks","_useState3","_useState4","setAudioTracks","videoRef","audioRef","trackpubsToTracks","trackMap","Array","from","values","map","publication","track","filter","audioTracks","on","kind","concat","v","removeAllListeners","videoTrack","attach","current","detach","className","identity","ref","autoPlay","muted","src_Room","token","handleLogout","room","setRoom","participants","setParticipants","remoteParticipants","key","sid","participantConnected","prevParticipants","participantDisconnected","p","connect","name","then","forEach","currentRoom","localParticipant","state","tracks","trackPublication","stop","disconnect","onClick","src_VideoChat","setUsername","setRoomName","_useState5","_useState6","setToken","event","target","mark","_callee","data","wrap","_context","prev","next","preventDefault","fetch","method","body","JSON","stringify","headers","Content-Type","res","json","sent","_x","apply","arguments","src_App_0","role","aria-label","href","Boolean","window","location","hostname","match","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","69","exports","74","75"],"mappings":"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"},"code":"(this[\"webpackJsonpreact-express-starter\"]=this[\"webpackJsonpreact-express-starter\"]||[]).push([[0],{184:function(e,t,n){\"use strict\";n.r(t);var a=n(0),r=n.n(a),c=n(66),o=n.n(c),i=(n(74),n(75),n(26)),u=n.n(i),l=n(67),m=n(7),s=function(e){var t=e.username,n=e.handleUsernameChange,a=e.roomName,c=e.handleRoomNameChange,o=e.handleSubmit;return r.a.createElement(\"form\",{onSubmit:o},r.a.createElement(\"h2\",null,\"Enter a room\"),r.a.createElement(\"div\",null,r.a.createElement(\"label\",{htmlFor:\"name\"},\"Name:\"),r.a.createElement(\"input\",{type:\"text\",id:\"field\",value:t,onChange:n,required:!0})),r.a.createElement(\"div\",null,r.a.createElement(\"label\",{htmlFor:\"room\"},\"Room name:\"),r.a.createElement(\"input\",{type:\"text\",id:\"room\",value:a,onChange:c,required:!0})),r.a.createElement(\"button\",{type:\"submit\"},\"Submit\"))},f=n(13),d=n(68),p=n.n(d),h=function(e){var t=e.participant,n=Object(a.useState)([]),c=Object(m.a)(n,2),o=c[0],i=c[1],u=Object(a.useState)([]),l=Object(m.a)(u,2),s=(l[0],l[1]),d=Object(a.useRef)(),p=Object(a.useRef)(),h=function(e){return Array.from(e.values()).map((function(e){return e.track})).filter((function(e){return null!==e}))};return Object(a.useEffect)((function(){return i(h(t.videoTracks)),s(h(t.audioTracks)),t.on(\"trackSubscribed\",(function(e){\"video\"===e.kind?i((function(t){return[].concat(Object(f.a)(t),[e])})):s((function(t){return[].concat(Object(f.a)(t),[e])}))})),t.on(\"trackUnsubscribed\",(function(e){\"video\"===e.kind?i((function(t){return t.filter((function(t){return t!==e}))})):s((function(t){return t.filter((function(t){return t!==e}))}))})),function(){i([]),s([]),t.removeAllListeners()}}),[t]),Object(a.useEffect)((function(){var e=o[0];if(e)return e.attach(d.current),function(){e.detach()}}),[o]),r.a.createElement(\"div\",{className:\"participant\"},r.a.createElement(\"h3\",null,t.identity),r.a.createElement(\"video\",{ref:d,autoPlay:!0}),r.a.createElement(\"audio\",{ref:p,autoPlay:!0,muted:!0}))},b=function(e){var t=e.roomName,n=e.token,c=e.handleLogout,o=Object(a.useState)(null),i=Object(m.a)(o,2),u=i[0],l=i[1],s=Object(a.useState)([]),d=Object(m.a)(s,2),b=d[0],E=d[1],v=b.map((function(e){return r.a.createElement(h,{key:e.sid,participant:e})}));return Object(a.useEffect)((function(){var e=function(e){E((function(t){return[].concat(Object(f.a)(t),[e])}))},a=function(e){E((function(t){return t.filter((function(t){return t!==e}))}))};return p.a.connect(n,{name:t}).then((function(t){l(t),t.on(\"participantConnected\",e),t.on(\"participantDisconnected\",a),t.participants.forEach(e)})),function(){l((function(e){return e&&\"connected\"===e.localParticipant.state?(e.localParticipant.tracks.forEach((function(e){e.track.stop()})),e.disconnect(),null):e}))}}),[t,n]),r.a.createElement(\"div\",{className:\"room\"},r.a.createElement(\"h2\",null,\"Room: \",t),r.a.createElement(\"button\",{onClick:c},\"Log out\"),r.a.createElement(\"div\",{className:\"local-participant\"},u?r.a.createElement(h,{key:u.localParticipant.sid,participant:u.localParticipant}):\"\"),r.a.createElement(\"h3\",null,\"Remote Participants\"),r.a.createElement(\"div\",{className:\"remote-participants\"},v))},E=function(){var e=Object(a.useState)(\"\"),t=Object(m.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(\"\"),i=Object(m.a)(o,2),f=i[0],d=i[1],p=Object(a.useState)(null),h=Object(m.a)(p,2),E=h[0],v=h[1],j=Object(a.useCallback)((function(e){c(e.target.value)}),[]),O=Object(a.useCallback)((function(e){d(e.target.value)}),[]),k=Object(a.useCallback)(function(){var e=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch(\"/login\",{method:\"POST\",body:JSON.stringify({identity:n,room:f}),headers:{\"Content-Type\":\"application/json\"}}).then((function(e){return e.json()}));case 3:a=e.sent,v(a.token);case 5:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n,f]),g=Object(a.useCallback)((function(e){v(null)}),[]);return E?r.a.createElement(b,{roomName:f,token:E,handleLogout:g}):r.a.createElement(s,{username:n,roomName:f,handleUsernameChange:j,handleRoomNameChange:O,handleSubmit:k})},v=function(){return r.a.createElement(\"div\",{className:\"app\"},r.a.createElement(\"header\",null,r.a.createElement(\"h1\",null,\"Video Chat with Hooks\")),r.a.createElement(\"main\",null,r.a.createElement(E,null)),r.a.createElement(\"footer\",null,r.a.createElement(\"p\",null,\"Made with\",\" \",r.a.createElement(\"span\",{role:\"img\",\"aria-label\":\"React\"},\"\\u269b\"),\" \",\"by \",r.a.createElement(\"a\",{href:\"https://twitter.com/philnash\"},\"philnash\"))))};Boolean(\"localhost\"===window.location.hostname||\"[::1]\"===window.location.hostname||window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(v,null)),document.getElementById(\"root\")),\"serviceWorker\"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},69:function(e,t,n){e.exports=n(184)},74:function(e,t,n){},75:function(e,t,n){}},[[69,1,2]]]);","extractedComments":[]}